{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 28, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bises/OneDrive/Desktop/digital-twin-team2/digital-twin-frontend/src/lib/auth-context.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { createContext, useContext, useState, useEffect, ReactNode } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\n\r\ninterface User {\r\n  id: string;\r\n  email: string;\r\n  name: string;\r\n}\r\n\r\ninterface AuthContextType {\r\n  user: User | null;\r\n  token: string | null;\r\n  isLoading: boolean;\r\n  isAuthenticated: boolean;\r\n  logout: () => void;\r\n}\r\n\r\nconst AuthContext = createContext<AuthContextType | undefined>(undefined);\r\n\r\nexport function AuthProvider({ children }: { children: ReactNode }) {\r\n  const [user, setUser] = useState<User | null>(null);\r\n  const [token, setToken] = useState<string | null>(null);\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const router = useRouter();\r\n\r\n  // Load auth state from localStorage on mount\r\n  useEffect(() => {\r\n    // Small delay to ensure client-side rendering\r\n    const timer = setTimeout(() => {\r\n      try {\r\n        const storedToken = localStorage.getItem('auth_token');\r\n        const storedUser = localStorage.getItem('auth_user');\r\n\r\n        console.log('Loading auth from localStorage:', { token: !!storedToken, user: !!storedUser });\r\n\r\n        if (storedToken && storedUser) {\r\n          const parsedUser = JSON.parse(storedUser);\r\n          setToken(storedToken);\r\n          setUser(parsedUser);\r\n          console.log('Auth loaded:', parsedUser);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error loading auth state:', error);\r\n      }\r\n\r\n      setIsLoading(false);\r\n    }, 0);\r\n\r\n    return () => clearTimeout(timer);\r\n  }, []);\r\n\r\n  const logout = () => {\r\n    console.log('Logging out user');\r\n    localStorage.removeItem('auth_token');\r\n    localStorage.removeItem('auth_user');\r\n    setToken(null);\r\n    setUser(null);\r\n    router.push('/login');\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider\r\n      value={{\r\n        user,\r\n        token,\r\n        isLoading,\r\n        isAuthenticated: !!token && !!user,\r\n        logout,\r\n      }}\r\n    >\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n}\r\n\r\nexport function useAuth() {\r\n  const context = useContext(AuthContext);\r\n  if (!context) {\r\n    throw new Error('useAuth must be used within an AuthProvider');\r\n  }\r\n  return context;\r\n}\r\n"],"names":[],"mappings":";;;;;;;AAEA;AACA;AAHA;;;;AAmBA,MAAM,4BAAc,IAAA,qPAAa,EAA8B;AAExD,SAAS,aAAa,EAAE,QAAQ,EAA2B;IAChE,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,gPAAQ,EAAc;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,gPAAQ,EAAgB;IAClD,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,gPAAQ,EAAC;IAC3C,MAAM,SAAS,IAAA,8KAAS;IAExB,6CAA6C;IAC7C,IAAA,iPAAS,EAAC;QACR,8CAA8C;QAC9C,MAAM,QAAQ,WAAW;YACvB,IAAI;gBACF,MAAM,cAAc,aAAa,OAAO,CAAC;gBACzC,MAAM,aAAa,aAAa,OAAO,CAAC;gBAExC,QAAQ,GAAG,CAAC,mCAAmC;oBAAE,OAAO,CAAC,CAAC;oBAAa,MAAM,CAAC,CAAC;gBAAW;gBAE1F,IAAI,eAAe,YAAY;oBAC7B,MAAM,aAAa,KAAK,KAAK,CAAC;oBAC9B,SAAS;oBACT,QAAQ;oBACR,QAAQ,GAAG,CAAC,gBAAgB;gBAC9B;YACF,EAAE,OAAO,OAAO;gBACd,QAAQ,KAAK,CAAC,6BAA6B;YAC7C;YAEA,aAAa;QACf,GAAG;QAEH,OAAO,IAAM,aAAa;IAC5B,GAAG,EAAE;IAEL,MAAM,SAAS;QACb,QAAQ,GAAG,CAAC;QACZ,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,SAAS;QACT,QAAQ;QACR,OAAO,IAAI,CAAC;IACd;IAEA,qBACE,6QAAC,YAAY,QAAQ;QACnB,OAAO;YACL;YACA;YACA;YACA,iBAAiB,CAAC,CAAC,SAAS,CAAC,CAAC;YAC9B;QACF;kBAEC;;;;;;AAGP;AAEO,SAAS;IACd,MAAM,UAAU,IAAA,kPAAU,EAAC;IAC3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IACA,OAAO;AACT"}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bises/OneDrive/Desktop/digital-twin-team2/digital-twin-frontend/src/constants/api.ts"],"sourcesContent":["// API Constants\r\n\r\nexport const API_BASE_URL = process.env.NEXT_PUBLIC_API_URL || \"http://localhost:3000/api\";\r\n\r\n// Parse timeout with validation to ensure we always have a valid number\r\nconst parseTimeout = (value: string | undefined): number => {\r\n  const defaultTimeout = 30000;\r\n  if (!value) return defaultTimeout;\r\n  \r\n  const parsed = parseInt(value, 10);\r\n  return !isNaN(parsed) && parsed > 0 ? parsed : defaultTimeout;\r\n};\r\n\r\nexport const API_TIMEOUT = parseTimeout(process.env.NEXT_PUBLIC_API_TIMEOUT);\r\n\r\nexport const API_ENDPOINTS = {\r\n  // Chat\r\n  CHAT: \"/chat\",\r\n  CHAT_MESSAGES: \"/chat/messages\",\r\n  CHAT_SESSIONS: \"/chat/sessions\",\r\n\r\n  // Insights\r\n  INSIGHTS: \"/insights\",\r\n  INSIGHTS_STATS: \"/insights/stats\",\r\n\r\n  // Users\r\n  USERS: \"/users\",\r\n  USERS_ME: \"/users/me\",\r\n  USERS_PROFILE: \"/users/profile\",\r\n\r\n  // Auth\r\n  AUTH_LOGIN: \"/auth/login\",\r\n  AUTH_LOGOUT: \"/auth/logout\",\r\n  AUTH_SIGNUP: \"/auth/signup\",\r\n} as const;\r\n\r\nexport const HTTP_STATUS = {\r\n  OK: 200,\r\n  CREATED: 201,\r\n  BAD_REQUEST: 400,\r\n  UNAUTHORIZED: 401,\r\n  FORBIDDEN: 403,\r\n  NOT_FOUND: 404,\r\n  INTERNAL_SERVER_ERROR: 500,\r\n} as const;\r\n"],"names":[],"mappings":"AAAA,gBAAgB;;;;;;;;;;;AAET,MAAM,eAAe,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAE/D,wEAAwE;AACxE,MAAM,eAAe,CAAC;IACpB,MAAM,iBAAiB;IACvB,IAAI,CAAC,OAAO,OAAO;IAEnB,MAAM,SAAS,SAAS,OAAO;IAC/B,OAAO,CAAC,MAAM,WAAW,SAAS,IAAI,SAAS;AACjD;AAEO,MAAM,cAAc,aAAa,QAAQ,GAAG,CAAC,uBAAuB;AAEpE,MAAM,gBAAgB;IAC3B,OAAO;IACP,MAAM;IACN,eAAe;IACf,eAAe;IAEf,WAAW;IACX,UAAU;IACV,gBAAgB;IAEhB,QAAQ;IACR,OAAO;IACP,UAAU;IACV,eAAe;IAEf,OAAO;IACP,YAAY;IACZ,aAAa;IACb,aAAa;AACf;AAEO,MAAM,cAAc;IACzB,IAAI;IACJ,SAAS;IACT,aAAa;IACb,cAAc;IACd,WAAW;IACX,WAAW;IACX,uBAAuB;AACzB"}},
    {"offset": {"line": 239, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bises/OneDrive/Desktop/digital-twin-team2/digital-twin-frontend/src/lib/api/client.ts"],"sourcesContent":["import axios, { AxiosInstance, AxiosError, AxiosRequestConfig } from \"axios\";\r\nimport { API_BASE_URL, API_TIMEOUT } from \"@/constants/api\";\r\n\r\ntype RedirectCallback = (url: string) => void;\r\n\r\nlet redirectCallback: RedirectCallback | null = null;\r\n\r\nexport function setApiRedirectCallback(callback: RedirectCallback) {\r\n  redirectCallback = callback;\r\n}\r\n\r\nclass ApiClient {\r\n  private client: AxiosInstance;\r\n\r\n  constructor() {\r\n    this.client = axios.create({\r\n      baseURL: API_BASE_URL,\r\n      timeout: API_TIMEOUT,\r\n      headers: {\r\n        \"Content-Type\": \"application/json\",\r\n      },\r\n    });\r\n\r\n    // Request interceptor\r\n    this.client.interceptors.request.use(\r\n      (config) => {\r\n        // Add auth token if available\r\n        const token = localStorage.getItem(\"auth_token\");\r\n        if (token) {\r\n          config.headers.Authorization = `Bearer ${token}`;\r\n        }\r\n        return config;\r\n      },\r\n      (error) => Promise.reject(error)\r\n    );\r\n\r\n    // Response interceptor\r\n    this.client.interceptors.response.use(\r\n      (response) => response,\r\n      (error: AxiosError) => {\r\n        if (error.response?.status === 401) {\r\n          // Handle unauthorized\r\n          localStorage.removeItem(\"auth_token\");\r\n          // Use callback if available, fallback to window.location\r\n          if (redirectCallback) {\r\n            redirectCallback(\"/login\");\r\n          } else {\r\n            window.location.href = \"/login\";\r\n          }\r\n        }\r\n        return Promise.reject(error);\r\n      }\r\n    );\r\n  }\r\n\r\n  async get<T>(url: string, config?: AxiosRequestConfig) {\r\n    return this.client.get<T>(url, config);\r\n  }\r\n\r\n  async post<T>(url: string, data?: unknown, config?: AxiosRequestConfig) {\r\n    return this.client.post<T>(url, data, config);\r\n  }\r\n\r\n  async put<T>(url: string, data?: unknown, config?: AxiosRequestConfig) {\r\n    return this.client.put<T>(url, data, config);\r\n  }\r\n\r\n  async patch<T>(url: string, data?: unknown, config?: AxiosRequestConfig) {\r\n    return this.client.patch<T>(url, data, config);\r\n  }\r\n\r\n  async delete<T>(url: string, config?: AxiosRequestConfig) {\r\n    return this.client.delete<T>(url, config);\r\n  }\r\n}\r\n\r\nexport const apiClient = new ApiClient();\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;AAIA,IAAI,mBAA4C;AAEzC,SAAS,uBAAuB,QAA0B;IAC/D,mBAAmB;AACrB;AAEA,MAAM;IACI,OAAsB;IAE9B,aAAc;QACZ,IAAI,CAAC,MAAM,GAAG,+KAAK,CAAC,MAAM,CAAC;YACzB,SAAS,sKAAY;YACrB,SAAS,qKAAW;YACpB,SAAS;gBACP,gBAAgB;YAClB;QACF;QAEA,sBAAsB;QACtB,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,OAAO,CAAC,GAAG,CAClC,CAAC;YACC,8BAA8B;YAC9B,MAAM,QAAQ,aAAa,OAAO,CAAC;YACnC,IAAI,OAAO;gBACT,OAAO,OAAO,CAAC,aAAa,GAAG,CAAC,OAAO,EAAE,OAAO;YAClD;YACA,OAAO;QACT,GACA,CAAC,QAAU,QAAQ,MAAM,CAAC;QAG5B,uBAAuB;QACvB,IAAI,CAAC,MAAM,CAAC,YAAY,CAAC,QAAQ,CAAC,GAAG,CACnC,CAAC,WAAa,UACd,CAAC;YACC,IAAI,MAAM,QAAQ,EAAE,WAAW,KAAK;gBAClC,sBAAsB;gBACtB,aAAa,UAAU,CAAC;gBACxB,yDAAyD;gBACzD,IAAI,kBAAkB;oBACpB,iBAAiB;gBACnB,OAAO;oBACL,OAAO,QAAQ,CAAC,IAAI,GAAG;gBACzB;YACF;YACA,OAAO,QAAQ,MAAM,CAAC;QACxB;IAEJ;IAEA,MAAM,IAAO,GAAW,EAAE,MAA2B,EAAE;QACrD,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAI,KAAK;IACjC;IAEA,MAAM,KAAQ,GAAW,EAAE,IAAc,EAAE,MAA2B,EAAE;QACtE,OAAO,IAAI,CAAC,MAAM,CAAC,IAAI,CAAI,KAAK,MAAM;IACxC;IAEA,MAAM,IAAO,GAAW,EAAE,IAAc,EAAE,MAA2B,EAAE;QACrE,OAAO,IAAI,CAAC,MAAM,CAAC,GAAG,CAAI,KAAK,MAAM;IACvC;IAEA,MAAM,MAAS,GAAW,EAAE,IAAc,EAAE,MAA2B,EAAE;QACvE,OAAO,IAAI,CAAC,MAAM,CAAC,KAAK,CAAI,KAAK,MAAM;IACzC;IAEA,MAAM,OAAU,GAAW,EAAE,MAA2B,EAAE;QACxD,OAAO,IAAI,CAAC,MAAM,CAAC,MAAM,CAAI,KAAK;IACpC;AACF;AAEO,MAAM,YAAY,IAAI"}},
    {"offset": {"line": 308, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/bises/OneDrive/Desktop/digital-twin-team2/digital-twin-frontend/src/components/providers/ApiProvider.tsx"],"sourcesContent":["'use client';\r\n\r\nimport { useEffect, ReactNode } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { setApiRedirectCallback } from '@/lib/api/client';\r\n\r\ninterface ApiProviderProps {\r\n  children: ReactNode;\r\n}\r\n\r\nexport function ApiProvider({ children }: ApiProviderProps) {\r\n  const router = useRouter();\r\n\r\n  useEffect(() => {\r\n    // Initialize API redirect callback with Next.js router\r\n    setApiRedirectCallback((url: string) => {\r\n      router.push(url);\r\n    });\r\n  }, [router]);\r\n\r\n  return <>{children}</>;\r\n}\r\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAUO,SAAS,YAAY,EAAE,QAAQ,EAAoB;IACxD,MAAM,SAAS,IAAA,8KAAS;IAExB,IAAA,iPAAS,EAAC;QACR,uDAAuD;QACvD,IAAA,oLAAsB,EAAC,CAAC;YACtB,OAAO,IAAI,CAAC;QACd;IACF,GAAG;QAAC;KAAO;IAEX,qBAAO;kBAAG;;AACZ"}}]
}